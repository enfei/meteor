import '../../imports/ui/layouts/not-found.html'
import '../../imports/ui/layouts/blank.html'
import '../../imports/ui/layouts/blank.js'
import '../../imports/ui/auth/login.html'
import '../../imports/ui/auth/login.js'
import '../../imports/ui/shell/shell.html'
import '../../imports/ui/shell/navigation.html'
import '../../imports/ui/shell/navigation.js'
import '../../imports/ui/shell/topNavBar.html'
import '../../imports/ui/shell/topNavBar.js'
import '../../imports/ui/shell/customAvatar.html'
import '../../imports/ui/shell/customAvatar.js'
import '../../imports/ui/shell/footer.html'
import '../../imports/ui/shell/footer.js'
import '../../imports/ui/shell/homepage.html'
import '../../imports/ui/shell/homepage.js'
import '../../imports/ui/shell/homepageLayout.html'
import '../../imports/ui/shell/productDetailsLayout.html'
import '../../imports/ui/shell/productDetailsLayout.js'
import '../../imports/ui/category/categoryDetails.html'
import '../../imports/ui/category/categoryDetails.js'
import '../../imports/ui/category/productList.html'
import '../../imports/ui/category/productList.js'
import '../../imports/ui/product/productDetails.html'
import '../../imports/ui/product/productDetails.js'
import '../../imports/ui/cart/cartPage.html'
import '../../imports/ui/cart/cartPage.js'
import '../../imports/ui/cart/address.html'
import '../../imports/ui/cart/address.js'
import '../../imports/ui/cart/shipping.html'
import '../../imports/ui/cart/shipping.js'
import '../../imports/ui/cart/payment.html'
import '../../imports/ui/cart/payment.js'
import '../../imports/ui/vendors/vendorAccount/tabs/editVendorProductOfferDetails.html'
import '../../imports/ui/vendors/vendorAccount/tabs/editVendorProductOfferDetails.js'
import '../../imports/ui/vendorPublicProfile/vendorPublicProfile.html'
import '../../imports/ui/vendorPublicProfile/vendorPublicProfile.js'
import '../../imports/ui/vendorPublicProfile/vendorPublicProfileReviews.html'
import '../../imports/ui/vendorPublicProfile/vendorPublicProfileReviews.js'
import '../../imports/ui/myTickets/myTickets.html'
import '../../imports/ui/myTickets/myTickets.js'
import '../../imports/ui/myTickets/myTicketsDetails.html'
import '../../imports/ui/myTickets/myticketsDetails.js'
import '../../imports/ui/myTickets/createMyTickets.html'
import '../../imports/ui/myTickets/createMyTickets.js'
import '../../imports/ui/customers/customerAccount/customerAccount.html'
import '../../imports/ui/customers/customerAccount/customerAccount.js'
import '../../imports/ui/customers/customerAccount/tabs/customerDashboardTab.html'
import '../../imports/ui/customers/customerAccount/tabs/customerDashboardTab.js'
import '../../imports/ui/customers/customerAccount/tabs/customerInformations.html'
import '../../imports/ui/customers/customerAccount/tabs/customerInformations.js'
import '../../imports/ui/customers/customerAccount/tabs/customerAddressesTab.html'
import '../../imports/ui/customers/customerAccount/tabs/customerAddressesTab.js'
import '../../imports/ui/customers/customerAccount/tabs/customerAlertsTab.html'
import '../../imports/ui/customers/customerAccount/tabs/customerAlertsTab.js'
import '../../imports/ui/customers/customerAccount/tabs/customerOrdersTab.html'
import '../../imports/ui/customers/customerAccount/tabs/customerOrdersTab.js'
import '../../imports/ui/customers/customerAccount/tabs/customerOrderDetails.html'
import '../../imports/ui/customers/customerAccount/tabs/customerOrderDetails.js'
import '../../imports/ui/customers/customerAccount/tabs/customerAddressesAdd.html'
import '../../imports/ui/customers/customerAccount/tabs/customerAddressesAdd.js'
import '../../imports/ui/customers/customerAccount/tabs/customerAddressesDetails.html'
import '../../imports/ui/customers/customerAccount/tabs/customerAddressesDetails.js'
import '../../imports/ui/customers/customerAccount/tabs/customerSettingsTab.html'
import '../../imports/ui/customers/customerAccount/tabs/customerSettingsTab.js'
import '../../imports/ui/vendors/vendorAccount/vendorAccount.html'
import '../../imports/ui/vendors/vendorAccount/vendorAccount.js'
import '../../imports/ui/vendors/vendorAccount/tabs/vendorFinancesTransactionDetails.html'
import '../../imports/ui/affiliate/affiliateAccount/affiliateAccount.html'
import '../../imports/ui/affiliate/affiliateAccount/affiliateAccount.js'
import '../../imports/ui/thanks/thanks.html'
import '../../imports/ui/thanks/thanks.js'
import '../../imports/ui/suggestedProducts/SuggestProduct.html'
import '../../imports/ui/suggestedProducts/SuggestProduct.js'
import '../../imports/ui/common/countriesFormSelect.html'
import '../../imports/ui/common/countriesFormSelect.js'
import '../../imports/ui/common/phoneFormInput.html'
import '../../imports/ui/common/phoneFormInput.js'
import '../../imports/ui/vendors/vendorAccount/tabs/vendorDashboardTab.html'
import '../../imports/ui/vendors/vendorAccount/tabs/vendorDashboardTab.js'
import '../../imports/ui/vendors/vendorAccount/tabs/vendorCatalogTab.html'
import '../../imports/ui/vendors/vendorAccount/tabs/vendorCatalogTab.js'
import '../../imports/ui/users/commonUsers/asVendor/asVendorHighlightOffer.html'
import '../../imports/ui/vendors/vendorAccount/tabs/vendorTransportTab.html'
import '../../imports/ui/vendors/vendorAccount/tabs/vendorTransportTab.js'
import '../../imports/ui/vendors/vendorAccount/tabs/vendorTransportAddCarrier.html'
import '../../imports/ui/vendors/vendorAccount/tabs/vendorTransportAddCarrier.js'
import '../../imports/ui/vendors/vendorAccount/tabs/vendorTransportEditCarrier.html'
import '../../imports/ui/vendors/vendorAccount/tabs/vendorTransportEditCarrier.js'
import '../../imports/ui/vendors/vendorAccount/tabs/vendorReviewsTab.html'
import '../../imports/ui/vendors/vendorAccount/tabs/vendorReviewsTab.js'
import '../../imports/ui/vendors/vendorAccount/tabs/vendorOrdersTab.html'
import '../../imports/ui/vendors/vendorAccount/tabs/vendorOrdersTab.js'
import '../../imports/ui/vendors/vendorAccount/tabs/vendorOrderDetails.html'
import '../../imports/ui/vendors/vendorAccount/tabs/vendorOrderDetails.js'
import '../../imports/ui/partial/statusDropdown.html'
import '../../imports/ui/partial/statusDropdown.js'
import '../../imports/ui/users/commonUsers/asVendor/asVendorReviewDetails.html'
import '../../imports/ui/users/commonUsers/asVendor/asVendorTransportTab.html'
import '../../imports/ui/users/commonUsers/asVendor/asVendorTransportTab.html'
import '../../imports/ui/users/commonUsers/asVendor/asVendorSaleDetails.html'
import '../../imports/ui/users/commonUsers/asVendor/asVendorReviewDetails.html'
import '../../imports/ui/users/commonUsers/asVendor/asVendorEditCarrier.html'
import '../../imports/ui/users/asAffiliate/asAffiliateBestSalesTab.html'
import '../../imports/ui/users/asAffiliate/asAffiliateBestSalesTab.html'
import '../../imports/ui/affiliate/affiliateAccount/tabs/affiliateXMLRessourceTab.html'
import '../../imports/ui/affiliate/affiliateAccount/tabs/affiliateCreateBannerTab.html'
import '../../imports/ui/affiliate/affiliateAccount/tabs/affiliateCreateBannerTab.js'
import '../../imports/ui/affiliate/affiliateAccount/tabs/affiliateDashboardTab.html'
import '../../imports/ui/affiliate/affiliateAccount/tabs/affiliateDashboardTab.js'
import '../../imports/ui/affiliate/affiliateAccount/tabs/affiliateSettingsTab.html'
import '../../imports/ui/affiliate/affiliateAccount/tabs/affiliateSettingsTab.js'
import '../../imports/ui/affiliate/affiliateAccount/tabs/affiliateBestSalesTab.html'
import '../../imports/ui/affiliate/affiliateAccount/tabs/affiliateFinancesTab.html'
import '../../imports/ui/affiliate/affiliateAccount/tabs/affiliateFinancesTab.js'
import '../../imports/ui/affiliate/affiliateAccount/tabs/affiliateVisitsTab.html'
import '../../imports/ui/affiliate/affiliateAccount/tabs/affiliateVisitsTab.js'
import '../../imports/ui/affiliate/affiliateAccount/tabs/affiliateEarning.html'
import '../../imports/ui/vendors/vendorAccount/tabs/vendorFinancesTab.html'
import '../../imports/ui/vendors/vendorAccount/tabs/vendorFinancesTab.js'
import '../../imports/ui/vendors/vendorAccount/tabs/vendorSettingsTab.html'
import '../../imports/ui/vendors/vendorAccount/tabs/vendorSettingsTab.js'
import '../../imports/ui/vendors/vendorAccount/tabs/vendorOrdersTab.html'
import '../../imports/ui/vendors/vendorAccount/tabs/vendorOrdersTab.js'
import '../../imports/ui/vendors/vendorAccount/tabs/vendorCatalogTab.html'
import '../../imports/ui/vendors/vendorAccount/tabs/vendorCatalogTab.js'
import '../../imports/ui/vendors/vendorTools/vendorToolsMyOffers.html'
import '../../imports/ui/vendors/vendorTools/vendorToolsMyOffers.js'
import '../../imports/ui/vendors/vendorTools/vendorToolsMyOffersOfferDetails.html'
import '../../imports/ui/vendors/vendorTools/vendorToolsMyOffersOfferDetails.js'
import '../../imports/ui/vendors/vendorTools/vendorToolsProductContribution.html'
import '../../imports/ui/vendors/vendorTools/vendorToolsProductContribution.js'
import '../../imports/ui/common/languageSelect.html'
import '../../imports/ui/common/languageSelect.js'
import '../../imports/ui/common/currencySelect.html'
import '../../imports/ui/common/currencySelect.js'
import '../../imports/ui/dashboards/dashboard-1.html'
import '../../imports/ui/dashboards/dashboard-1.js'
import '../../imports/ui/common/profile.html'
import '../../imports/ui/common/profile.js'
import '../../imports/ui/common/page-heading.html'
import '../../imports/ui/common/page-heading.js'
import '../../imports/ui/common/ibox-tools.html'
import '../../imports/ui/common/ibox-tools.js'
import '../../imports/ui/appviews/contacts.html'
import '../../imports/ui/mailbox/mailbox.html'
import '../../imports/ui/mailbox/mailbox.js'
import '../../imports/ui/mailbox/emailCompose.html'
import '../../imports/ui/mailbox/emailCompose.js'
import '../../imports/ui/mailbox/emailTemplates.html'
import '../../imports/ui/mailbox/emailView.html'
import '../../imports/ui/mailbox/emailView.js'
import '../../imports/ui/common/showMapModal.html'
import '../../imports/ui/common/showMapModal.js'
import '../../imports/ui/otherPages/changePassword.html'
import '../../imports/ui/otherPages/changePassword.js'
import '../../imports/ui/otherPages/forgotPassword.html'
import '../../imports/ui/otherPages/forgotPassword.js'
import '../../imports/ui/otherPages/register.html'
import '../../imports/ui/otherPages/register.js'
import '../../imports/ui/otherPages/resetPassword.html'
import '../../imports/ui/otherPages/resetPassword.js'
import '../../imports/ui/imageCropper/imageCropper.html'
import '../../imports/ui/imageCropper/imageCropper.js'

import '../../imports/ui/cms/cmsCatPageViewer.html'
import '../../imports/ui/cms/cmsCatPageViewer.js'
import '../../imports/ui/cms/cmsDocPageViewer.html'
import '../../imports/ui/cms/cmsDocPageViewer.js'
import '../../imports/ui/languageBar/languageBar.html'
import '../../imports/ui/languageBar/languageBar.js'

import '../../imports/ui/category/searchResultCategories.html'
import '../../imports/ui/category/searchResultCategories.js'


import '../../imports/ui/test/test.html'
import '../../imports/ui/test/test.js'

/***for testing purpose****/
FlowRouter.route( '/test', {
    subscriptions: function(){
        this.register( 'Products', Meteor.subscribe( 'products' ));
    },
    action: function() {
        BlazeLayout.render( 'shell', { childViews: 'test' });
    }
});

//doesn't allow user to go without login
FlowRouter.triggers.enter([isUserLogin, isAffiliate, initializeTooltip]);

function isUserLogin(){
    if(!Meteor.userId()){
        FlowRouter.go('login')
    }
}

//check is any affiliate linked?

function isAffiliate(context, redirect, stop){
    if( context.queryParams && context.queryParams.af ){
        Session.set('affiliateLinked', true);
        Session.set('affiliateId', context.queryParams.af)
    }
}

function initializeTooltip(){
    $('[data-toggle="tooltip"]').tooltip();
}

//global subscription for users
FlowRouter.subscriptions = function() {
    this.register(Meteor.subscribe('userData'));
    this.register( 'Categories', Meteor.subscribe( 'categories' ));
    this.register( 'Languages', Meteor.subscribe( 'languages' ));
    this.register( 'Currencies', Meteor.subscribe( 'currencies' ));
    this.register( 'Countries', Meteor.subscribe( 'countries' ));
    this.register( 'Settings', Meteor.subscribe( 'settings' ));
};

FlowRouter.route( '/notFound', {
    action: function() {
        BlazeLayout.render( 'shell', { childViews: 'notFound' });
    }
});


//Accounts related Routes
FlowRouter.route( '/login', {
    name: 'login',
    action: function() {
        BlazeLayout.render( 'mainLayout', { main: 'login' } );
    }
});

var parentRoutes = FlowRouter.group({
    prefix: '',
    name: 'admin'
});

FlowRouter.route( '/forgotPassword', {
    name: 'forgotPassword',
    action: function() {
        BlazeLayout.render( 'mainLayout', { main: 'forgotPassword' } )
    }
});

FlowRouter.route( '/resetpassword/:token', {
    name: 'resetPassword',
    action: function() {
        BlazeLayout.render( 'mainLayout', { main: 'resetPassword' } )
    }
});

FlowRouter.route( '/register', {
    name: 'register',
    action: function() {
        BlazeLayout.render( 'mainLayout', { main: 'register' } )
    }
});


parentRoutes.route( '/search/:id', {
    subscriptions: function(params, queryParams){

        //search keyword if exists
        var search = queryParams.search;
        Session.set('searchKeyWord', search);

        //set default values if not given
        var page = parseInt(queryParams.page) || 1;
        //decrease page to 1 to default index set to 1
        page--;
        var limit = parseInt(queryParams.limit) || 12;

        var sort = {};
        var sorting = queryParams.sort;
        if ( sorting ) {

            var doReverse = queryParams.doReverse;
            if( doReverse == 'true'){
                sort[sorting] = -1
            }
            else{
                sort[sorting] = 1
            }
        }

        var offset = page*limit;
        Session.set('limit', limit);
        this.register('Features', Meteor.subscribe('features'));
        this.register('Products', Meteor.subscribe('productsWithSkip', offset, sort, params.id, search));
        this.register('Offers', Meteor.subscribe('offers'));
    },
    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'categoryDetails' });
    },
    name : 'search'
});

parentRoutes.route( '/productDetails/:id?', {

    subscriptions: function(params, queryParams){

        //set default values if not given

        var page = parseInt(queryParams.page) || 1;
        //decrease page to 1 to default index set to 1
        page--;
        var limit = parseInt(queryParams.limit) || 100;

        var sort = {};
        var sorting = queryParams.sort;
        if ( sorting ) {

            var doReverse = queryParams.doReverse;
            if( doReverse == 'true'){
                sort[sorting] = -1
            }
            else{
                sort[sorting] = 1
            }
        }

        var offset = page*limit;
        this.register('Features', Meteor.subscribe('features'));
        this.register( 'Categories', Meteor.subscribe( 'categories' ));
        this.register( 'Products', Meteor.subscribe( 'products' ));
        this.register( 'Carrier', Meteor.subscribe( 'carrier' ));
        this.register( 'Attributes', Meteor.subscribe( 'attributes' ));
        this.register('Offers', Meteor.subscribe('offersWithSkip', offset, limit, sort));
    },

    action: ()=>{
        BlazeLayout.render( 'productDetailsLayout', { childViews: 'productDetails' });
    },

    name: 'productDetails'

});


parentRoutes.route( '/cartPage', {
    triggersEnter: [isUserLogin],
    subscriptions: function(){
        this.register('Countries', Meteor.subscribe('countries'));
        this.register('Carrier', Meteor.subscribe('carrier'));
        this.register('Products', Meteor.subscribe('products'));
        this.register('Offers', Meteor.subscribe('offers'));
        //this.register('Settings', Meteor.subscribe('settings'));
    },

    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'cartPage' });
    },
    name: 'cartPage'
});


parentRoutes.route( '/homepage', {
    action: ()=>{
        BlazeLayout.render( 'homepageLayout', { childViews: 'homepage' });
    },
    subscriptions: function(){
        this.register('Products', Meteor.subscribe('products'));
    },
    name: 'homepage'
});


parentRoutes.route( '/register', {
    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'register' });
    },
    name: 'register'
});

parentRoutes.route( '/vendorPublicProfile', {
    subscriptions: function(params, queryParams){
        //set default values if not given
        var page = parseInt(queryParams.page) || 1;
        //decrease page to 1 to default index set to 1
        page--;
        var limit = parseInt(queryParams.limit) || 5;

        var sort = {};
        var sorting = queryParams.sort;
        if ( sorting ) {

            var doReverse = queryParams.doReverse;
            if( doReverse == 'true'){
                sort[sorting] = -1
            }
            else{
                sort[sorting] = 1
            }
        }

        var offset = page*limit;
        this.register('Products', Meteor.subscribe('productsWithSkip', offset, limit, sort));
    },

    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'vendorPublicProfile' });
    },
    name: 'vendorPublicProfile'
});

parentRoutes.route( '/vendorTransportAddCarrier', {
    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'vendorTransportAddCarrier' });
    },
    name: 'vendorTransportAddCarrier'
});

parentRoutes.route( '/vendorTransportEditCarrier/:id', {
    subscriptions: function(){
        this.register('Carrier', Meteor.subscribe( 'carrier' ));
    },
    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'vendorTransportEditCarrier' });
    },
    name: 'vendorTransportEditCarrier'
});

parentRoutes.route( '/vendorFinancesTransactionDetails', {
    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'vendorFinancesTransactionDetails' });
    },
    name: 'vendorFinancesTransactionDetails'
});

parentRoutes.route( '/myTickets', {
    subscriptions: function(){
        this.register('Tickets', Meteor.subscribe( 'tickets' ));
        this.register('Messages', Meteor.subscribe( 'messages'));
    },
    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'myTickets' });
    },
    name: 'myTickets'
});

parentRoutes.route( '/createMyTickets', {
    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'createMyTickets' });
    },
    name: 'createMyTickets'
});

parentRoutes.route( '/myTicketsDetails/:_id?', {
    subscriptions: function(){
        this.register('Tickets', Meteor.subscribe( 'tickets' ));
        this.register('Messages', Meteor.subscribe( 'messages'));
    },
    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'myTicketsDetails' });
    },
    name: 'myTicketsDetails'
});

parentRoutes.route( '/vendorPublicProfileReviews', {
    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'vendorPublicProfileReviews' });
    },
    subscriptions: function(){
        this.register('Products', Meteor.subscribe('products'));
    },
    name: 'vendorPublicProfileReviews'
});


parentRoutes.route( '/dashboard1', {
    subscriptions: function(){
        this.register('Categories', Meteor.subscribe( 'categories' ));
        this.register('Products', Meteor.subscribe( 'products' ));
    },

    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'dashboard1' });
    },
    name: 'dashboard1'
});

parentRoutes.route( '/', {
    action: ()=>{
        FlowRouter.go('dashboard1')
    }
});

parentRoutes.route( '/vendorOrderDetails/:id?', {
    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'vendorOrderDetails' });
    },
    subscriptions: function(){
        this.register('Orders', Meteor.subscribe('myOrders'));
        this.register('Products', Meteor.subscribe('allProducts'));
        this.register('Offers', Meteor.subscribe('offers'));
        this.register('Carrier', Meteor.subscribe('carrier'));
        this.register('Payments', Meteor.subscribe('payments'));
    },
    name: 'vendorOrderDetails'
});

parentRoutes.route( '/editVendorProductOfferDetails/:id', {

    subscriptions: function(){
        this.register('Products', Meteor.subscribe('products'));
        this.register('Offers', Meteor.subscribe('offers'));
        this.register('Carrier', Meteor.subscribe('carrier'));
    },

    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'editVendorProductOfferDetails' });
    },
    name: 'editVendorProductOfferDetails'
});

parentRoutes.route( '/thanks', {
    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'thanks' });
    },
    subscriptions: function(){
        this.register('Products', Meteor.subscribe('products'));
        this.register( 'Settings', Meteor.subscribe( 'settings' ));
    },
    name: 'thanks'
});
parentRoutes.route( '/SuggestProduct', {
    subscriptions: function(){
        this.register('Attributes', Meteor.subscribe('attributes'));
        this.register('SuggestProduct', Meteor.subscribe('suggestedProducts'));
        this.register('Skills', Meteor.subscribe('skills'));
        this.register('Categories', Meteor.subscribe('categories'));
        this.register('Features', Meteor.subscribe('features'));
        this.register('Languages', Meteor.subscribe('languages'));
    },
    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'SuggestProduct' });
    },
    name: 'SuggestProduct'
});

parentRoutes.route( '/profile', {
    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'profile' });
    },
    name: 'profile'
});

parentRoutes.route( '/contacts', {
    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'contacts' });
    },
    name: 'contacts'
});

parentRoutes.route( '/mailbox', {
    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'mailbox' });
    },
    name: 'mailbox'
});

parentRoutes.route( '/emailCompose', {
    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'emailCompose' });
    },
    name: 'emailCompose'
});

parentRoutes.route( '/emailView', {
    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'emailView' });
    },
    name: 'emailView'
});

//configure no route Found
FlowRouter.notFound = {
    action: function() {
        BlazeLayout.render( 'shell', { childViews: 'notFound' });
    }
};

/***** CUSTOMER *****/
parentRoutes.route('/customerAccount', {

    action: ()=>{
        //here we go to first child route
        FlowRouter.go('customerDashboard');
    },
    name:'customerAccount'

});

parentRoutes.route('/customerOrderDetails/:id', {
    subscriptions: function(){
        this.register('Orders', Meteor.subscribe('orders'));
        this.register('Products', Meteor.subscribe('products'));
        this.register('Carrier', Meteor.subscribe('carrier'));
    },
    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'customerOrderDetails'})
    },
    name: 'customerOrderDetails'
});

parentRoutes.route('/customerAddressesDetails/:index?', {
    subscriptions: function(){
        this.register('Countries', Meteor.subscribe('countries'));
    },

    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'customerAddressesDetails'})
    },
    name: 'customerAddressesDetails'
});

parentRoutes.route('/customerAddressesAdd/',{
    subscriptions: function(){
        this.register('Countries', Meteor.subscribe('countries'));
    },

    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'customerAddressesAdd'})
    },
    name: 'customerAddressesAdd'
});

//customer account sub routes
var customerAccountRoutes = parentRoutes.group({
    prefix: "/customer",
    name: "customer"
});

customerAccountRoutes.route('/dashboard', {
    subscriptions: function(params, queryParams){

        //set default values if not given
        var page = parseInt(queryParams.page) || 1;
        //decrease page to 1 to default index set to 1
        page--;
        //var limit = parseInt(queryParams.limit) || 3;
        var limit = parseInt(queryParams.limit);

        var sort = {};
        var sorting = queryParams.sort;
        if ( sorting ) {

            var doReverse = queryParams.doReverse;
            if( doReverse == 'true'){
                sort[sorting] = -1
            }
            else{
                sort[sorting] = 1
            }
        }

        var offset = page*limit;

        this.register('Products', Meteor.subscribe('productPubsSubscribe', offset, limit, sort));

        this.register('Orders', Meteor.subscribe('orders'));

        this.register('Tickets', Meteor.subscribe('tickets'));
    },

    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'customerAccount',
            customersTabsContents: 'customerDashboardTab' });
    },
    name: 'customerDashboard'
});

customerAccountRoutes.route('/informations', {
    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'customerAccount',
            customersTabsContents: 'customerInformations'});
    },
    name: 'customerInformations'
});

customerAccountRoutes.route('/orders', {

    subscriptions: function(){
        this.register('Orders', Meteor.subscribe('orders'));
    },
    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'customerAccount',
            customersTabsContents: 'customerOrdersTab'});
    },
    name: 'customerOrders'
});

customerAccountRoutes.route('/addresses', {
    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'customerAccount',
            customersTabsContents: 'customerAddressesTab'});
    },
    name: 'customerAddresses'
});

customerAccountRoutes.route('/alerts', {
    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'customerAccount',
            customersTabsContents: 'customerAlertsTab'});
    },
    subscriptions: function(){
        this.register('Products', Meteor.subscribe('products'));
    },
    name: 'customerAlerts'
});

customerAccountRoutes.route('/settings', {
    subscriptions: function(){
        this.register('Languages', Meteor.subscribe('languages'));
        this.register('Countries', Meteor.subscribe('countries'));
    },

    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'customerAccount',
            customersTabsContents: 'customerSettingsTab'});
    },
    name: 'customerSettings'
});

/***** VENDOR *****/
parentRoutes.route('/vendorAccount', {

    action: ()=>{
        //here we go to first child route
        FlowRouter.go('vendorDashboard');
    },
    name:'vendorAccount'

});

//vendor account sub routes
var vendorAccountRoutes = parentRoutes.group({
    prefix: "/vendor",
    name: "vendor"
});

vendorAccountRoutes.route('/dashboard', {
    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'vendorAccount',
            vendorsTabsContents: 'vendorDashboardTab' });
    },
    name: 'vendorDashboard'
});

vendorAccountRoutes.route('/catalog', {

    subscriptions: function(){
        this.register('Products', Meteor.subscribe('products'));
        this.register('Offers', Meteor.subscribe('offers'));
    },

    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'vendorAccount',
            vendorsTabsContents: 'vendorCatalogTab'});
    },
    name: 'vendorCatalog'
});

vendorAccountRoutes.route('/orders', {
    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'vendorAccount',
            vendorsTabsContents: 'vendorOrdersTab'});
    },
    subscriptions: function(){
        this.register('Orders', Meteor.subscribe('orders'));
    },
    name: 'vendorOrders'
});
//
vendorAccountRoutes.route('/transport', {
    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'vendorAccount',
            vendorsTabsContents: 'vendorTransportTab'});
    },
    subscriptions: function(){
        this.register('Carrier', Meteor.subscribe('carrier'));
    },
    name: 'vendorTransport'
});

vendorAccountRoutes.route('/reviews', {
    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'vendorAccount',
            vendorsTabsContents: 'vendorReviewsTab'});
    },
    subscriptions: function(){
        this.register('ReviewsCriteria', Meteor.subscribe('reviewsCriteria'));
    },
    name: 'vendorReviews'
});

vendorAccountRoutes.route('/finances', {
    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'vendorAccount',
            vendorsTabsContents: 'vendorFinancesTab'});
    },
    name: 'vendorFinances'
});

vendorAccountRoutes.route('/settings', {
    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'vendorAccount',
            vendorsTabsContents: 'vendorSettingsTab'});
    },
    name: 'vendorSettings'
});

/***** AFFILIATE *****/
parentRoutes.route('/affiliateAccount', {

    action: ()=>{
        //here we go to first child route
        FlowRouter.go('affiliateDashboard');
    },
    name:'affiliateAccount'

});

//affiliate account sub routes
var affiliateAccountRoutes = parentRoutes.group({
    prefix: "/affiliate",
    name: "affiliate"
});

affiliateAccountRoutes.route('/dashboard', {
    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'affiliateAccount',
            vendorsTabsContents: 'affiliateDashboardTab' });
    },
    subscriptions: function(){
        this.register('Products', Meteor.subscribe('products'));
        this.register('Offers', Meteor.subscribe('offers'));
    },
    name: 'affiliateDashboard'
});

affiliateAccountRoutes.route('/earning', {
    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'affiliateAccount',
            vendorsTabsContents: 'affiliateEarningTab' });
    },
    name: 'affiliateEarning'
});

affiliateAccountRoutes.route('/bestSales', {
    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'affiliateAccount',
            vendorsTabsContents: 'affiliateBestSalesTab' });
    },
    name: 'affiliateBestSales'
});

affiliateAccountRoutes.route('/visits', {
    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'affiliateAccount',
            vendorsTabsContents: 'affiliateVisitsTab' });
    },
    name: 'affiliateVisits'
});

affiliateAccountRoutes.route('/finances', {
    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'affiliateAccount',
            vendorsTabsContents: 'affiliateFinancesTab' });
    },
    name: 'affiliateFinances'
});

affiliateAccountRoutes.route('/settings', {
    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'affiliateAccount',
            vendorsTabsContents: 'affiliateSettingsTab' });
    },
    name: 'affiliateSettings'
});

affiliateAccountRoutes.route('/createBanner', {
    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'affiliateAccount',
            vendorsTabsContents: 'affiliateCreateBannerTab' });
    },
    name: 'affiliateCreateBanner'
});

affiliateAccountRoutes.route('/XMLRessource', {
    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'affiliateAccount',
            vendorsTabsContents: 'affiliateXMLRessourceTab' });
    },
    name: 'affiliateXMLRessource'
});


//CMS routes
parentRoutes.route( '/cmsCatPageViewer', {
    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'cmsCatPageViewer' });
    },
    name: 'cmsCatPageViewer'
});

parentRoutes.route( '/cmsDocPageViewer', {
    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'cmsDocPageViewer' });
    },
    name: 'cmsDocPageViewer'
});

/***** VENDORTOOLS *****/
parentRoutes.route('/vendorToolsMyOffers/:id?', {

    subscriptions: function(params){
        this.register('Offers', Meteor.subscribe('offersWithId', {product: params.id}));
        this.register('Products', Meteor.subscribe('activeProduct', {_id: params.id}));
    },

    action: ()=>{
        //here we go to first child route
        BlazeLayout.render( 'shell', { childViews: 'vendorToolsMyOffers' });
    },
    name:'vendorToolsMyOffers'

});

parentRoutes.route('/vendorToolsMyOffersOfferDetails/:id?', {

    subscriptions: function(){
        this.register('Offers', Meteor.subscribe('offers'));
        this.register( 'Carrier', Meteor.subscribe( 'carrier' ));
        this.register( 'Products', Meteor.subscribe( 'products' ));
    },

    action: ()=>{
        //here we go to first child route
        BlazeLayout.render( 'shell', { childViews: 'vendorToolsMyOffersOfferDetails' });
    },
    name:'vendorToolsMyOffersOfferDetails'

});

parentRoutes.route('/vendorToolsProductContribution/:productId?', {

    subscriptions: function(){
        this.register('Attributes', Meteor.subscribe('attributes'));
        this.register('SuggestProduct', Meteor.subscribe('suggestedProducts'));
        this.register('Products', Meteor.subscribe('products'));
        this.register('Skills', Meteor.subscribe('skills'));
        this.register('Categories', Meteor.subscribe('categories'));
        this.register('Features', Meteor.subscribe('features'));
        this.register('Languages', Meteor.subscribe('languages'));
    },

    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'vendorToolsProductContribution' });
    },
    name: 'vendorToolsProductContribution'
});

parentRoutes.route('/test', {
    name: 'test',
    action: ()=>{
        BlazeLayout.render( 'shell', { childViews: 'test' });
    }
});

